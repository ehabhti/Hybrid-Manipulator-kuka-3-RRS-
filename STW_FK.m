syms h10 h20 h30 h11 h21 h31 h12 h22 h32 h13 h23 h33 h14 h24 h34 h15 h25 h35 h16 h26 h36 t1 t3 t1fi1 wx wy wz
%b=56;p=56;l1=25;l2=61;th1=-80;th2=80;th3=-80;
b=500;p=250;l1=750;l2=850;th1=-44.84;th2=-45.51;th3=-49.46;
h10=3*b^2+2*l1^2+2*l2^2-3*p^2+l1*cosd(th1)*(3*b+l1*cosd(th2))+3*b*l1*cosd(th2)-2*l1^2*sind(th1)*sind(th2);
h20=3*b^2+2*l1^2+2*l2^2-3*p^2+l1*cosd(th2)*(3*b+l1*cosd(th3))+3*b*l1*cosd(th3)-2*l1^2*sind(th2)*sind(th3);
h30=3*b^2+2*l1^2+2*l2^2-3*p^2+l1*cosd(th3)*(3*b+l1*cosd(th1))+3*b*l1*cosd(th1)-2*l1^2*sind(th3)*sind(th1);
h11=l2*(3*b+2*l1*cosd(th1)+l1*cosd(th2));
h21=l2*(3*b+2*l1*cosd(th2)+l1*cosd(th3));
h31=l2*(3*b+2*l1*cosd(th3)+l1*cosd(th1));
h12=l2*(3*b+l1*cosd(th1)+2*l1*cosd(th2));
h22=l2*(3*b+l1*cosd(th2)+2*l1*cosd(th3));
h32=l2*(3*b+l1*cosd(th3)+2*l1*cosd(th1));
h13=l2^2;
h23=l2^2;
h33=l2^2;
h14=2*l1*l2*(sind(th1)-sind(th2));
h24=2*l1*l2*(sind(th2)-sind(th3));
h34=2*l1*l2*(sind(th3)-sind(th1));
h15=-2*l1*l2*(sind(th1)-sind(th2));
h25=-2*l1*l2*(sind(th2)-sind(th3));
h35=-2*l1*l2*(sind(th3)-sind(th1));
h16=-2*l2^2;
h26=-2*l2^2;
h36=-2*l2^2;
%{
f10=h10+h11+2*h14*t1+(h10-h11)*t1^2
f11=h15+2*h16*t1+h15*t1^2;
f12=h12+h13+(h12-h13)*t1^2;
f20=h20+h22+2*h25*t3+(h20-h22)*t3^2;
f21=h24+2*h26*t3+h24*t3^2;
f22=h21+h23+(h21-h23)*t3^2;
p=(f12*f20-f10*f22)^2+(f10*f21-f11*f20)^2-(f11*f22-f12*f21)^2==0;
collect(p, t1)
%}
a0=(h10^2*h21^2*t3^4 + 2*h10^2*h21^2*t3^2 + h10^2*h21^2 - 2*h10^2*h21*h23*t3^4 + 2*h10^2*h21*h23 + h10^2*h23^2*t3^4 - 2*h10^2*h23^2*t3^2 + h10^2*h23^2 + h10^2*h24^2*t3^4 + 2*h10^2*h24^2*t3^2 + h10^2*h24^2 + 4*h10^2*h24*h26*t3^3 + 4*h10^2*h24*h26*t3 + 4*h10^2*h26^2*t3^2 + 2*h10*h11*h21^2*t3^4 + 4*h10*h11*h21^2*t3^2 + 2*h10*h11*h21^2 - 4*h10*h11*h21*h23*t3^4 + 4*h10*h11*h21*h23 + 2*h10*h11*h23^2*t3^4 - 4*h10*h11*h23^2*t3^2 + 2*h10*h11*h23^2 + 2*h10*h11*h24^2*t3^4 + 4*h10*h11*h24^2*t3^2 + 2*h10*h11*h24^2 + 8*h10*h11*h24*h26*t3^3 + 8*h10*h11*h24*h26*t3 + 8*h10*h11*h26^2*t3^2 - 2*h10*h12*h20*h21*t3^4 - 4*h10*h12*h20*h21*t3^2 - 2*h10*h12*h20*h21 + 2*h10*h12*h20*h23*t3^4 - 2*h10*h12*h20*h23 + 2*h10*h12*h21*h22*t3^4 - 2*h10*h12*h21*h22 - 4*h10*h12*h21*h25*t3^3 - 4*h10*h12*h21*h25*t3 - 2*h10*h12*h22*h23*t3^4 + 4*h10*h12*h22*h23*t3^2 - 2*h10*h12*h22*h23 + 4*h10*h12*h23*h25*t3^3 - 4*h10*h12*h23*h25*t3 - 2*h10*h13*h20*h21*t3^4 - 4*h10*h13*h20*h21*t3^2 - 2*h10*h13*h20*h21 + 2*h10*h13*h20*h23*t3^4 - 2*h10*h13*h20*h23 + 2*h10*h13*h21*h22*t3^4 - 2*h10*h13*h21*h22 - 4*h10*h13*h21*h25*t3^3 - 4*h10*h13*h21*h25*t3 - 2*h10*h13*h22*h23*t3^4 + 4*h10*h13*h22*h23*t3^2 - 2*h10*h13*h22*h23 + 4*h10*h13*h23*h25*t3^3 - 4*h10*h13*h23*h25*t3 - 2*h10*h15*h20*h24*t3^4 - 4*h10*h15*h20*h24*t3^2 - 2*h10*h15*h20*h24 - 4*h10*h15*h20*h26*t3^3 - 4*h10*h15*h20*h26*t3 + 2*h10*h15*h22*h24*t3^4 - 2*h10*h15*h22*h24 + 4*h10*h15*h22*h26*t3^3 - 4*h10*h15*h22*h26*t3 - 4*h10*h15*h24*h25*t3^3 - 4*h10*h15*h24*h25*t3 - 8*h10*h15*h25*h26*t3^2 + h11^2*h21^2*t3^4 + 2*h11^2*h21^2*t3^2 + h11^2*h21^2 - 2*h11^2*h21*h23*t3^4 + 2*h11^2*h21*h23 + h11^2*h23^2*t3^4 - 2*h11^2*h23^2*t3^2 + h11^2*h23^2 + h11^2*h24^2*t3^4 + 2*h11^2*h24^2*t3^2 + h11^2*h24^2 + 4*h11^2*h24*h26*t3^3 + 4*h11^2*h24*h26*t3 + 4*h11^2*h26^2*t3^2 - 2*h11*h12*h20*h21*t3^4 - 4*h11*h12*h20*h21*t3^2 - 2*h11*h12*h20*h21 + 2*h11*h12*h20*h23*t3^4 - 2*h11*h12*h20*h23 + 2*h11*h12*h21*h22*t3^4 - 2*h11*h12*h21*h22 - 4*h11*h12*h21*h25*t3^3 - 4*h11*h12*h21*h25*t3 - 2*h11*h12*h22*h23*t3^4 + 4*h11*h12*h22*h23*t3^2 - 2*h11*h12*h22*h23 + 4*h11*h12*h23*h25*t3^3 - 4*h11*h12*h23*h25*t3 - 2*h11*h13*h20*h21*t3^4 - 4*h11*h13*h20*h21*t3^2 - 2*h11*h13*h20*h21 + 2*h11*h13*h20*h23*t3^4 - 2*h11*h13*h20*h23 + 2*h11*h13*h21*h22*t3^4 - 2*h11*h13*h21*h22 - 4*h11*h13*h21*h25*t3^3 - 4*h11*h13*h21*h25*t3 - 2*h11*h13*h22*h23*t3^4 + 4*h11*h13*h22*h23*t3^2 - 2*h11*h13*h22*h23 + 4*h11*h13*h23*h25*t3^3 - 4*h11*h13*h23*h25*t3 - 2*h11*h15*h20*h24*t3^4 - 4*h11*h15*h20*h24*t3^2 - 2*h11*h15*h20*h24 - 4*h11*h15*h20*h26*t3^3 - 4*h11*h15*h20*h26*t3 + 2*h11*h15*h22*h24*t3^4 - 2*h11*h15*h22*h24 + 4*h11*h15*h22*h26*t3^3 - 4*h11*h15*h22*h26*t3 - 4*h11*h15*h24*h25*t3^3 - 4*h11*h15*h24*h25*t3 - 8*h11*h15*h25*h26*t3^2 + h12^2*h20^2*t3^4 + 2*h12^2*h20^2*t3^2 + h12^2*h20^2 - 2*h12^2*h20*h22*t3^4 + 2*h12^2*h20*h22 + 4*h12^2*h20*h25*t3^3 + 4*h12^2*h20*h25*t3 + h12^2*h22^2*t3^4 - 2*h12^2*h22^2*t3^2 + h12^2*h22^2 - 4*h12^2*h22*h25*t3^3 + 4*h12^2*h22*h25*t3 - h12^2*h24^2*t3^4 - 2*h12^2*h24^2*t3^2 - h12^2*h24^2 - 4*h12^2*h24*h26*t3^3 - 4*h12^2*h24*h26*t3 + 4*h12^2*h25^2*t3^2 - 4*h12^2*h26^2*t3^2 + 2*h12*h13*h20^2*t3^4 + 4*h12*h13*h20^2*t3^2 + 2*h12*h13*h20^2 - 4*h12*h13*h20*h22*t3^4 + 4*h12*h13*h20*h22 + 8*h12*h13*h20*h25*t3^3 + 8*h12*h13*h20*h25*t3 + 2*h12*h13*h22^2*t3^4 - 4*h12*h13*h22^2*t3^2 + 2*h12*h13*h22^2 - 8*h12*h13*h22*h25*t3^3 + 8*h12*h13*h22*h25*t3 - 2*h12*h13*h24^2*t3^4 - 4*h12*h13*h24^2*t3^2 - 2*h12*h13*h24^2 - 8*h12*h13*h24*h26*t3^3 - 8*h12*h13*h24*h26*t3 + 8*h12*h13*h25^2*t3^2 - 8*h12*h13*h26^2*t3^2 + 2*h12*h15*h21*h24*t3^4 + 4*h12*h15*h21*h24*t3^2 + 2*h12*h15*h21*h24 + 4*h12*h15*h21*h26*t3^3 + 4*h12*h15*h21*h26*t3 - 2*h12*h15*h23*h24*t3^4 + 2*h12*h15*h23*h24 - 4*h12*h15*h23*h26*t3^3 + 4*h12*h15*h23*h26*t3 + h13^2*h20^2*t3^4 + 2*h13^2*h20^2*t3^2 + h13^2*h20^2 - 2*h13^2*h20*h22*t3^4 + 2*h13^2*h20*h22 + 4*h13^2*h20*h25*t3^3 + 4*h13^2*h20*h25*t3 + h13^2*h22^2*t3^4 - 2*h13^2*h22^2*t3^2 + h13^2*h22^2 - 4*h13^2*h22*h25*t3^3 + 4*h13^2*h22*h25*t3 - h13^2*h24^2*t3^4 - 2*h13^2*h24^2*t3^2 - h13^2*h24^2 - 4*h13^2*h24*h26*t3^3 - 4*h13^2*h24*h26*t3 + 4*h13^2*h25^2*t3^2 - 4*h13^2*h26^2*t3^2 + 2*h13*h15*h21*h24*t3^4 + 4*h13*h15*h21*h24*t3^2 + 2*h13*h15*h21*h24 + 4*h13*h15*h21*h26*t3^3 + 4*h13*h15*h21*h26*t3 - 2*h13*h15*h23*h24*t3^4 + 2*h13*h15*h23*h24 - 4*h13*h15*h23*h26*t3^3 + 4*h13*h15*h23*h26*t3 + h15^2*h20^2*t3^4 + 2*h15^2*h20^2*t3^2 + h15^2*h20^2 - 2*h15^2*h20*h22*t3^4 + 2*h15^2*h20*h22 + 4*h15^2*h20*h25*t3^3 + 4*h15^2*h20*h25*t3 - h15^2*h21^2*t3^4 - 2*h15^2*h21^2*t3^2 - h15^2*h21^2 + 2*h15^2*h21*h23*t3^4 - 2*h15^2*h21*h23 + h15^2*h22^2*t3^4 - 2*h15^2*h22^2*t3^2 + h15^2*h22^2 - 4*h15^2*h22*h25*t3^3 + 4*h15^2*h22*h25*t3 - h15^2*h23^2*t3^4 + 2*h15^2*h23^2*t3^2 - h15^2*h23^2 + 4*h15^2*h25^2*t3^2);
a1=(4*h10*h14*h21^2 + 4*h11*h14*h21^2 + 4*h10*h14*h23^2 + 4*h10*h14*h24^2 + 4*h11*h14*h23^2 + 4*h11*h14*h24^2 + 4*h15*h16*h20^2 - 4*h15*h16*h21^2 + 4*h15*h16*h22^2 - 4*h15*h16*h23^2 + 8*h10*h14*h21^2*t3^2 + 8*h11*h14*h21^2*t3^2 + 4*h10*h14*h21^2*t3^4 - 8*h10*h14*h23^2*t3^2 + 8*h10*h14*h24^2*t3^2 + 4*h11*h14*h21^2*t3^4 - 8*h11*h14*h23^2*t3^2 + 4*h10*h14*h23^2*t3^4 + 8*h11*h14*h24^2*t3^2 + 4*h10*h14*h24^2*t3^4 + 16*h10*h14*h26^2*t3^2 + 4*h11*h14*h23^2*t3^4 + 4*h11*h14*h24^2*t3^4 + 16*h11*h14*h26^2*t3^2 + 8*h15*h16*h20^2*t3^2 - 8*h15*h16*h21^2*t3^2 + 4*h15*h16*h20^2*t3^4 - 8*h15*h16*h22^2*t3^2 - 4*h15*h16*h21^2*t3^4 + 8*h15*h16*h23^2*t3^2 + 4*h15*h16*h22^2*t3^4 - 4*h15*h16*h23^2*t3^4 + 16*h15*h16*h25^2*t3^2 - 4*h12*h14*h20*h21 + 8*h10*h14*h21*h23 - 4*h13*h14*h20*h21 + 8*h11*h14*h21*h23 - 4*h12*h14*h20*h23 - 4*h12*h14*h21*h22 - 4*h10*h16*h20*h24 - 4*h13*h14*h20*h23 - 4*h13*h14*h21*h22 - 4*h11*h16*h20*h24 - 4*h12*h14*h22*h23 - 4*h10*h16*h22*h24 - 4*h13*h14*h22*h23 - 4*h11*h16*h22*h24 + 4*h12*h16*h21*h24 - 4*h14*h15*h20*h24 + 8*h15*h16*h20*h22 + 4*h13*h16*h21*h24 + 4*h12*h16*h23*h24 - 4*h14*h15*h22*h24 - 8*h15*h16*h21*h23 + 4*h13*h16*h23*h24 - 8*h10*h16*h20*h26*t3 - 8*h12*h14*h21*h25*t3 - 8*h11*h16*h20*h26*t3 - 8*h13*h14*h21*h25*t3 + 16*h10*h14*h24*h26*t3 - 8*h10*h16*h22*h26*t3 - 8*h12*h14*h23*h25*t3 - 8*h10*h16*h24*h25*t3 + 16*h11*h14*h24*h26*t3 - 8*h11*h16*h22*h26*t3 + 8*h12*h16*h21*h26*t3 - 8*h13*h14*h23*h25*t3 - 8*h14*h15*h20*h26*t3 - 8*h11*h16*h24*h25*t3 + 8*h13*h16*h21*h26*t3 + 16*h15*h16*h20*h25*t3 + 8*h12*h16*h23*h26*t3 - 8*h14*h15*h22*h26*t3 + 8*h13*h16*h23*h26*t3 - 8*h14*h15*h24*h25*t3 + 16*h15*h16*h22*h25*t3 - 8*h12*h14*h20*h21*t3^2 - 8*h13*h14*h20*h21*t3^2 - 4*h12*h14*h20*h21*t3^4 - 8*h10*h14*h21*h23*t3^4 - 8*h10*h16*h20*h24*t3^2 - 4*h13*h14*h20*h21*t3^4 - 8*h11*h14*h21*h23*t3^4 - 8*h11*h16*h20*h24*t3^2 + 4*h12*h14*h20*h23*t3^4 + 4*h12*h14*h21*h22*t3^4 + 8*h12*h14*h22*h23*t3^2 - 4*h10*h16*h20*h24*t3^4 + 4*h13*h14*h20*h23*t3^4 + 4*h13*h14*h21*h22*t3^4 + 8*h13*h14*h22*h23*t3^2 - 8*h10*h16*h20*h26*t3^3 - 4*h11*h16*h20*h24*t3^4 - 8*h12*h14*h21*h25*t3^3 - 4*h12*h14*h22*h23*t3^4 + 8*h12*h16*h21*h24*t3^2 - 8*h14*h15*h20*h24*t3^2 + 4*h10*h16*h22*h24*t3^4 - 8*h11*h16*h20*h26*t3^3 - 8*h13*h14*h21*h25*t3^3 - 4*h13*h14*h22*h23*t3^4 + 8*h13*h16*h21*h24*t3^2 + 16*h10*h14*h24*h26*t3^3 + 8*h10*h16*h22*h26*t3^3 + 4*h11*h16*h22*h24*t3^4 + 8*h12*h14*h23*h25*t3^3 + 4*h12*h16*h21*h24*t3^4 - 4*h14*h15*h20*h24*t3^4 - 8*h15*h16*h20*h22*t3^4 - 8*h10*h16*h24*h25*t3^3 + 16*h11*h14*h24*h26*t3^3 + 8*h11*h16*h22*h26*t3^3 + 8*h12*h16*h21*h26*t3^3 + 8*h13*h14*h23*h25*t3^3 + 4*h13*h16*h21*h24*t3^4 - 8*h14*h15*h20*h26*t3^3 - 16*h10*h16*h25*h26*t3^2 - 8*h11*h16*h24*h25*t3^3 - 4*h12*h16*h23*h24*t3^4 + 8*h13*h16*h21*h26*t3^3 + 4*h14*h15*h22*h24*t3^4 + 16*h15*h16*h20*h25*t3^3 + 8*h15*h16*h21*h23*t3^4 - 16*h11*h16*h25*h26*t3^2 - 8*h12*h16*h23*h26*t3^3 - 4*h13*h16*h23*h24*t3^4 + 8*h14*h15*h22*h26*t3^3 - 8*h13*h16*h23*h26*t3^3 - 8*h14*h15*h24*h25*t3^3 - 16*h15*h16*h22*h25*t3^3 - 16*h14*h15*h25*h26*t3^2);
a2=(2*h10^2*h21^2*t3^4 + 4*h10^2*h21^2*t3^2 + 2*h10^2*h21^2 - 4*h10^2*h21*h23*t3^4 + 4*h10^2*h21*h23 + 2*h10^2*h23^2*t3^4 - 4*h10^2*h23^2*t3^2 + 2*h10^2*h23^2 + 2*h10^2*h24^2*t3^4 + 4*h10^2*h24^2*t3^2 + 2*h10^2*h24^2 + 8*h10^2*h24*h26*t3^3 + 8*h10^2*h24*h26*t3 + 8*h10^2*h26^2*t3^2 - 4*h10*h12*h20*h21*t3^4 - 8*h10*h12*h20*h21*t3^2 - 4*h10*h12*h20*h21 + 4*h10*h12*h20*h23*t3^4 - 4*h10*h12*h20*h23 + 4*h10*h12*h21*h22*t3^4 - 4*h10*h12*h21*h22 - 8*h10*h12*h21*h25*t3^3 - 8*h10*h12*h21*h25*t3 - 4*h10*h12*h22*h23*t3^4 + 8*h10*h12*h22*h23*t3^2 - 4*h10*h12*h22*h23 + 8*h10*h12*h23*h25*t3^3 - 8*h10*h12*h23*h25*t3 - 4*h10*h15*h20*h24*t3^4 - 8*h10*h15*h20*h24*t3^2 - 4*h10*h15*h20*h24 - 8*h10*h15*h20*h26*t3^3 - 8*h10*h15*h20*h26*t3 + 4*h10*h15*h22*h24*t3^4 - 4*h10*h15*h22*h24 + 8*h10*h15*h22*h26*t3^3 - 8*h10*h15*h22*h26*t3 - 8*h10*h15*h24*h25*t3^3 - 8*h10*h15*h24*h25*t3 - 16*h10*h15*h25*h26*t3^2 - 2*h11^2*h21^2*t3^4 - 4*h11^2*h21^2*t3^2 - 2*h11^2*h21^2 + 4*h11^2*h21*h23*t3^4 - 4*h11^2*h21*h23 - 2*h11^2*h23^2*t3^4 + 4*h11^2*h23^2*t3^2 - 2*h11^2*h23^2 - 2*h11^2*h24^2*t3^4 - 4*h11^2*h24^2*t3^2 - 2*h11^2*h24^2 - 8*h11^2*h24*h26*t3^3 - 8*h11^2*h24*h26*t3 - 8*h11^2*h26^2*t3^2 + 4*h11*h13*h20*h21*t3^4 + 8*h11*h13*h20*h21*t3^2 + 4*h11*h13*h20*h21 - 4*h11*h13*h20*h23*t3^4 + 4*h11*h13*h20*h23 - 4*h11*h13*h21*h22*t3^4 + 4*h11*h13*h21*h22 + 8*h11*h13*h21*h25*t3^3 + 8*h11*h13*h21*h25*t3 + 4*h11*h13*h22*h23*t3^4 - 8*h11*h13*h22*h23*t3^2 + 4*h11*h13*h22*h23 - 8*h11*h13*h23*h25*t3^3 + 8*h11*h13*h23*h25*t3 + 2*h12^2*h20^2*t3^4 + 4*h12^2*h20^2*t3^2 + 2*h12^2*h20^2 - 4*h12^2*h20*h22*t3^4 + 4*h12^2*h20*h22 + 8*h12^2*h20*h25*t3^3 + 8*h12^2*h20*h25*t3 + 2*h12^2*h22^2*t3^4 - 4*h12^2*h22^2*t3^2 + 2*h12^2*h22^2 - 8*h12^2*h22*h25*t3^3 + 8*h12^2*h22*h25*t3 - 2*h12^2*h24^2*t3^4 - 4*h12^2*h24^2*t3^2 - 2*h12^2*h24^2 - 8*h12^2*h24*h26*t3^3 - 8*h12^2*h24*h26*t3 + 8*h12^2*h25^2*t3^2 - 8*h12^2*h26^2*t3^2 + 4*h12*h15*h21*h24*t3^4 + 8*h12*h15*h21*h24*t3^2 + 4*h12*h15*h21*h24 + 8*h12*h15*h21*h26*t3^3 + 8*h12*h15*h21*h26*t3 - 4*h12*h15*h23*h24*t3^4 + 4*h12*h15*h23*h24 - 8*h12*h15*h23*h26*t3^3 + 8*h12*h15*h23*h26*t3 - 2*h13^2*h20^2*t3^4 - 4*h13^2*h20^2*t3^2 - 2*h13^2*h20^2 + 4*h13^2*h20*h22*t3^4 - 4*h13^2*h20*h22 - 8*h13^2*h20*h25*t3^3 - 8*h13^2*h20*h25*t3 - 2*h13^2*h22^2*t3^4 + 4*h13^2*h22^2*t3^2 - 2*h13^2*h22^2 + 8*h13^2*h22*h25*t3^3 - 8*h13^2*h22*h25*t3 + 2*h13^2*h24^2*t3^4 + 4*h13^2*h24^2*t3^2 + 2*h13^2*h24^2 + 8*h13^2*h24*h26*t3^3 + 8*h13^2*h24*h26*t3 - 8*h13^2*h25^2*t3^2 + 8*h13^2*h26^2*t3^2 + 4*h14^2*h21^2*t3^4 + 8*h14^2*h21^2*t3^2 + 4*h14^2*h21^2 - 8*h14^2*h21*h23*t3^4 + 8*h14^2*h21*h23 + 4*h14^2*h23^2*t3^4 - 8*h14^2*h23^2*t3^2 + 4*h14^2*h23^2 + 4*h14^2*h24^2*t3^4 + 8*h14^2*h24^2*t3^2 + 4*h14^2*h24^2 + 16*h14^2*h24*h26*t3^3 + 16*h14^2*h24*h26*t3 + 16*h14^2*h26^2*t3^2 - 8*h14*h16*h20*h24*t3^4 - 16*h14*h16*h20*h24*t3^2 - 8*h14*h16*h20*h24 - 16*h14*h16*h20*h26*t3^3 - 16*h14*h16*h20*h26*t3 + 8*h14*h16*h22*h24*t3^4 - 8*h14*h16*h22*h24 + 16*h14*h16*h22*h26*t3^3 - 16*h14*h16*h22*h26*t3 - 16*h14*h16*h24*h25*t3^3 - 16*h14*h16*h24*h25*t3 - 32*h14*h16*h25*h26*t3^2 + 2*h15^2*h20^2*t3^4 + 4*h15^2*h20^2*t3^2 + 2*h15^2*h20^2 - 4*h15^2*h20*h22*t3^4 + 4*h15^2*h20*h22 + 8*h15^2*h20*h25*t3^3 + 8*h15^2*h20*h25*t3 - 2*h15^2*h21^2*t3^4 - 4*h15^2*h21^2*t3^2 - 2*h15^2*h21^2 + 4*h15^2*h21*h23*t3^4 - 4*h15^2*h21*h23 + 2*h15^2*h22^2*t3^4 - 4*h15^2*h22^2*t3^2 + 2*h15^2*h22^2 - 8*h15^2*h22*h25*t3^3 + 8*h15^2*h22*h25*t3 - 2*h15^2*h23^2*t3^4 + 4*h15^2*h23^2*t3^2 - 2*h15^2*h23^2 + 8*h15^2*h25^2*t3^2 + 4*h16^2*h20^2*t3^4 + 8*h16^2*h20^2*t3^2 + 4*h16^2*h20^2 - 8*h16^2*h20*h22*t3^4 + 8*h16^2*h20*h22 + 16*h16^2*h20*h25*t3^3 + 16*h16^2*h20*h25*t3 - 4*h16^2*h21^2*t3^4 - 8*h16^2*h21^2*t3^2 - 4*h16^2*h21^2 + 8*h16^2*h21*h23*t3^4 - 8*h16^2*h21*h23 + 4*h16^2*h22^2*t3^4 - 8*h16^2*h22^2*t3^2 + 4*h16^2*h22^2 - 16*h16^2*h22*h25*t3^3 + 16*h16^2*h22*h25*t3 - 4*h16^2*h23^2*t3^4 + 8*h16^2*h23^2*t3^2 - 4*h16^2*h23^2 + 16*h16^2*h25^2*t3^2);
a3=(4*h10*h14*h21^2 - 4*h11*h14*h21^2 + 4*h10*h14*h23^2 + 4*h10*h14*h24^2 - 4*h11*h14*h23^2 - 4*h11*h14*h24^2 + 4*h15*h16*h20^2 - 4*h15*h16*h21^2 + 4*h15*h16*h22^2 - 4*h15*h16*h23^2 + 8*h10*h14*h21^2*t3^2 - 8*h11*h14*h21^2*t3^2 + 4*h10*h14*h21^2*t3^4 - 8*h10*h14*h23^2*t3^2 + 8*h10*h14*h24^2*t3^2 - 4*h11*h14*h21^2*t3^4 + 8*h11*h14*h23^2*t3^2 + 4*h10*h14*h23^2*t3^4 - 8*h11*h14*h24^2*t3^2 + 4*h10*h14*h24^2*t3^4 + 16*h10*h14*h26^2*t3^2 - 4*h11*h14*h23^2*t3^4 - 4*h11*h14*h24^2*t3^4 - 16*h11*h14*h26^2*t3^2 + 8*h15*h16*h20^2*t3^2 - 8*h15*h16*h21^2*t3^2 + 4*h15*h16*h20^2*t3^4 - 8*h15*h16*h22^2*t3^2 - 4*h15*h16*h21^2*t3^4 + 8*h15*h16*h23^2*t3^2 + 4*h15*h16*h22^2*t3^4 - 4*h15*h16*h23^2*t3^4 + 16*h15*h16*h25^2*t3^2 - 4*h12*h14*h20*h21 + 8*h10*h14*h21*h23 + 4*h13*h14*h20*h21 - 8*h11*h14*h21*h23 - 4*h12*h14*h20*h23 - 4*h12*h14*h21*h22 - 4*h10*h16*h20*h24 + 4*h13*h14*h20*h23 + 4*h13*h14*h21*h22 + 4*h11*h16*h20*h24 - 4*h12*h14*h22*h23 - 4*h10*h16*h22*h24 + 4*h13*h14*h22*h23 + 4*h11*h16*h22*h24 + 4*h12*h16*h21*h24 - 4*h14*h15*h20*h24 + 8*h15*h16*h20*h22 - 4*h13*h16*h21*h24 + 4*h12*h16*h23*h24 - 4*h14*h15*h22*h24 - 8*h15*h16*h21*h23 - 4*h13*h16*h23*h24 - 8*h10*h16*h20*h26*t3 - 8*h12*h14*h21*h25*t3 + 8*h11*h16*h20*h26*t3 + 8*h13*h14*h21*h25*t3 + 16*h10*h14*h24*h26*t3 - 8*h10*h16*h22*h26*t3 - 8*h12*h14*h23*h25*t3 - 8*h10*h16*h24*h25*t3 - 16*h11*h14*h24*h26*t3 + 8*h11*h16*h22*h26*t3 + 8*h12*h16*h21*h26*t3 + 8*h13*h14*h23*h25*t3 - 8*h14*h15*h20*h26*t3 + 8*h11*h16*h24*h25*t3 - 8*h13*h16*h21*h26*t3 + 16*h15*h16*h20*h25*t3 + 8*h12*h16*h23*h26*t3 - 8*h14*h15*h22*h26*t3 - 8*h13*h16*h23*h26*t3 - 8*h14*h15*h24*h25*t3 + 16*h15*h16*h22*h25*t3 - 8*h12*h14*h20*h21*t3^2 + 8*h13*h14*h20*h21*t3^2 - 4*h12*h14*h20*h21*t3^4 - 8*h10*h14*h21*h23*t3^4 - 8*h10*h16*h20*h24*t3^2 + 4*h13*h14*h20*h21*t3^4 + 8*h11*h14*h21*h23*t3^4 + 8*h11*h16*h20*h24*t3^2 + 4*h12*h14*h20*h23*t3^4 + 4*h12*h14*h21*h22*t3^4 + 8*h12*h14*h22*h23*t3^2 - 4*h10*h16*h20*h24*t3^4 - 4*h13*h14*h20*h23*t3^4 - 4*h13*h14*h21*h22*t3^4 - 8*h13*h14*h22*h23*t3^2 - 8*h10*h16*h20*h26*t3^3 + 4*h11*h16*h20*h24*t3^4 - 8*h12*h14*h21*h25*t3^3 - 4*h12*h14*h22*h23*t3^4 + 8*h12*h16*h21*h24*t3^2 - 8*h14*h15*h20*h24*t3^2 + 4*h10*h16*h22*h24*t3^4 + 8*h11*h16*h20*h26*t3^3 + 8*h13*h14*h21*h25*t3^3 + 4*h13*h14*h22*h23*t3^4 - 8*h13*h16*h21*h24*t3^2 + 16*h10*h14*h24*h26*t3^3 + 8*h10*h16*h22*h26*t3^3 - 4*h11*h16*h22*h24*t3^4 + 8*h12*h14*h23*h25*t3^3 + 4*h12*h16*h21*h24*t3^4 - 4*h14*h15*h20*h24*t3^4 - 8*h15*h16*h20*h22*t3^4 - 8*h10*h16*h24*h25*t3^3 - 16*h11*h14*h24*h26*t3^3 - 8*h11*h16*h22*h26*t3^3 + 8*h12*h16*h21*h26*t3^3 - 8*h13*h14*h23*h25*t3^3 - 4*h13*h16*h21*h24*t3^4 - 8*h14*h15*h20*h26*t3^3 - 16*h10*h16*h25*h26*t3^2 + 8*h11*h16*h24*h25*t3^3 - 4*h12*h16*h23*h24*t3^4 - 8*h13*h16*h21*h26*t3^3 + 4*h14*h15*h22*h24*t3^4 + 16*h15*h16*h20*h25*t3^3 + 8*h15*h16*h21*h23*t3^4 + 16*h11*h16*h25*h26*t3^2 - 8*h12*h16*h23*h26*t3^3 + 4*h13*h16*h23*h24*t3^4 + 8*h14*h15*h22*h26*t3^3 + 8*h13*h16*h23*h26*t3^3 - 8*h14*h15*h24*h25*t3^3 - 16*h15*h16*h22*h25*t3^3 - 16*h14*h15*h25*h26*t3^2);
a4=(h10^2*h21^2*t3^4 + 2*h10^2*h21^2*t3^2 + h10^2*h21^2 - 2*h10^2*h21*h23*t3^4 + 2*h10^2*h21*h23 + h10^2*h23^2*t3^4 - 2*h10^2*h23^2*t3^2 + h10^2*h23^2 + h10^2*h24^2*t3^4 + 2*h10^2*h24^2*t3^2 + h10^2*h24^2 + 4*h10^2*h24*h26*t3^3 + 4*h10^2*h24*h26*t3 + 4*h10^2*h26^2*t3^2 - 2*h10*h11*h21^2*t3^4 - 4*h10*h11*h21^2*t3^2 - 2*h10*h11*h21^2 + 4*h10*h11*h21*h23*t3^4 - 4*h10*h11*h21*h23 - 2*h10*h11*h23^2*t3^4 + 4*h10*h11*h23^2*t3^2 - 2*h10*h11*h23^2 - 2*h10*h11*h24^2*t3^4 - 4*h10*h11*h24^2*t3^2 - 2*h10*h11*h24^2 - 8*h10*h11*h24*h26*t3^3 - 8*h10*h11*h24*h26*t3 - 8*h10*h11*h26^2*t3^2 - 2*h10*h12*h20*h21*t3^4 - 4*h10*h12*h20*h21*t3^2 - 2*h10*h12*h20*h21 + 2*h10*h12*h20*h23*t3^4 - 2*h10*h12*h20*h23 + 2*h10*h12*h21*h22*t3^4 - 2*h10*h12*h21*h22 - 4*h10*h12*h21*h25*t3^3 - 4*h10*h12*h21*h25*t3 - 2*h10*h12*h22*h23*t3^4 + 4*h10*h12*h22*h23*t3^2 - 2*h10*h12*h22*h23 + 4*h10*h12*h23*h25*t3^3 - 4*h10*h12*h23*h25*t3 + 2*h10*h13*h20*h21*t3^4 + 4*h10*h13*h20*h21*t3^2 + 2*h10*h13*h20*h21 - 2*h10*h13*h20*h23*t3^4 + 2*h10*h13*h20*h23 - 2*h10*h13*h21*h22*t3^4 + 2*h10*h13*h21*h22 + 4*h10*h13*h21*h25*t3^3 + 4*h10*h13*h21*h25*t3 + 2*h10*h13*h22*h23*t3^4 - 4*h10*h13*h22*h23*t3^2 + 2*h10*h13*h22*h23 - 4*h10*h13*h23*h25*t3^3 + 4*h10*h13*h23*h25*t3 - 2*h10*h15*h20*h24*t3^4 - 4*h10*h15*h20*h24*t3^2 - 2*h10*h15*h20*h24 - 4*h10*h15*h20*h26*t3^3 - 4*h10*h15*h20*h26*t3 + 2*h10*h15*h22*h24*t3^4 - 2*h10*h15*h22*h24 + 4*h10*h15*h22*h26*t3^3 - 4*h10*h15*h22*h26*t3 - 4*h10*h15*h24*h25*t3^3 - 4*h10*h15*h24*h25*t3 - 8*h10*h15*h25*h26*t3^2 + h11^2*h21^2*t3^4 + 2*h11^2*h21^2*t3^2 + h11^2*h21^2 - 2*h11^2*h21*h23*t3^4 + 2*h11^2*h21*h23 + h11^2*h23^2*t3^4 - 2*h11^2*h23^2*t3^2 + h11^2*h23^2 + h11^2*h24^2*t3^4 + 2*h11^2*h24^2*t3^2 + h11^2*h24^2 + 4*h11^2*h24*h26*t3^3 + 4*h11^2*h24*h26*t3 + 4*h11^2*h26^2*t3^2 + 2*h11*h12*h20*h21*t3^4 + 4*h11*h12*h20*h21*t3^2 + 2*h11*h12*h20*h21 - 2*h11*h12*h20*h23*t3^4 + 2*h11*h12*h20*h23 - 2*h11*h12*h21*h22*t3^4 + 2*h11*h12*h21*h22 + 4*h11*h12*h21*h25*t3^3 + 4*h11*h12*h21*h25*t3 + 2*h11*h12*h22*h23*t3^4 - 4*h11*h12*h22*h23*t3^2 + 2*h11*h12*h22*h23 - 4*h11*h12*h23*h25*t3^3 + 4*h11*h12*h23*h25*t3 - 2*h11*h13*h20*h21*t3^4 - 4*h11*h13*h20*h21*t3^2 - 2*h11*h13*h20*h21 + 2*h11*h13*h20*h23*t3^4 - 2*h11*h13*h20*h23 + 2*h11*h13*h21*h22*t3^4 - 2*h11*h13*h21*h22 - 4*h11*h13*h21*h25*t3^3 - 4*h11*h13*h21*h25*t3 - 2*h11*h13*h22*h23*t3^4 + 4*h11*h13*h22*h23*t3^2 - 2*h11*h13*h22*h23 + 4*h11*h13*h23*h25*t3^3 - 4*h11*h13*h23*h25*t3 + 2*h11*h15*h20*h24*t3^4 + 4*h11*h15*h20*h24*t3^2 + 2*h11*h15*h20*h24 + 4*h11*h15*h20*h26*t3^3 + 4*h11*h15*h20*h26*t3 - 2*h11*h15*h22*h24*t3^4 + 2*h11*h15*h22*h24 - 4*h11*h15*h22*h26*t3^3 + 4*h11*h15*h22*h26*t3 + 4*h11*h15*h24*h25*t3^3 + 4*h11*h15*h24*h25*t3 + 8*h11*h15*h25*h26*t3^2 + h12^2*h20^2*t3^4 + 2*h12^2*h20^2*t3^2 + h12^2*h20^2 - 2*h12^2*h20*h22*t3^4 + 2*h12^2*h20*h22 + 4*h12^2*h20*h25*t3^3 + 4*h12^2*h20*h25*t3 + h12^2*h22^2*t3^4 - 2*h12^2*h22^2*t3^2 + h12^2*h22^2 - 4*h12^2*h22*h25*t3^3 + 4*h12^2*h22*h25*t3 - h12^2*h24^2*t3^4 - 2*h12^2*h24^2*t3^2 - h12^2*h24^2 - 4*h12^2*h24*h26*t3^3 - 4*h12^2*h24*h26*t3 + 4*h12^2*h25^2*t3^2 - 4*h12^2*h26^2*t3^2 - 2*h12*h13*h20^2*t3^4 - 4*h12*h13*h20^2*t3^2 - 2*h12*h13*h20^2 + 4*h12*h13*h20*h22*t3^4 - 4*h12*h13*h20*h22 - 8*h12*h13*h20*h25*t3^3 - 8*h12*h13*h20*h25*t3 - 2*h12*h13*h22^2*t3^4 + 4*h12*h13*h22^2*t3^2 - 2*h12*h13*h22^2 + 8*h12*h13*h22*h25*t3^3 - 8*h12*h13*h22*h25*t3 + 2*h12*h13*h24^2*t3^4 + 4*h12*h13*h24^2*t3^2 + 2*h12*h13*h24^2 + 8*h12*h13*h24*h26*t3^3 + 8*h12*h13*h24*h26*t3 - 8*h12*h13*h25^2*t3^2 + 8*h12*h13*h26^2*t3^2 + 2*h12*h15*h21*h24*t3^4 + 4*h12*h15*h21*h24*t3^2 + 2*h12*h15*h21*h24 + 4*h12*h15*h21*h26*t3^3 + 4*h12*h15*h21*h26*t3 - 2*h12*h15*h23*h24*t3^4 + 2*h12*h15*h23*h24 - 4*h12*h15*h23*h26*t3^3 + 4*h12*h15*h23*h26*t3 + h13^2*h20^2*t3^4 + 2*h13^2*h20^2*t3^2 + h13^2*h20^2 - 2*h13^2*h20*h22*t3^4 + 2*h13^2*h20*h22 + 4*h13^2*h20*h25*t3^3 + 4*h13^2*h20*h25*t3 + h13^2*h22^2*t3^4 - 2*h13^2*h22^2*t3^2 + h13^2*h22^2 - 4*h13^2*h22*h25*t3^3 + 4*h13^2*h22*h25*t3 - h13^2*h24^2*t3^4 - 2*h13^2*h24^2*t3^2 - h13^2*h24^2 - 4*h13^2*h24*h26*t3^3 - 4*h13^2*h24*h26*t3 + 4*h13^2*h25^2*t3^2 - 4*h13^2*h26^2*t3^2 - 2*h13*h15*h21*h24*t3^4 - 4*h13*h15*h21*h24*t3^2 - 2*h13*h15*h21*h24 - 4*h13*h15*h21*h26*t3^3 - 4*h13*h15*h21*h26*t3 + 2*h13*h15*h23*h24*t3^4 - 2*h13*h15*h23*h24 + 4*h13*h15*h23*h26*t3^3 - 4*h13*h15*h23*h26*t3 + h15^2*h20^2*t3^4 + 2*h15^2*h20^2*t3^2 + h15^2*h20^2 - 2*h15^2*h20*h22*t3^4 + 2*h15^2*h20*h22 + 4*h15^2*h20*h25*t3^3 + 4*h15^2*h20*h25*t3 - h15^2*h21^2*t3^4 - 2*h15^2*h21^2*t3^2 - h15^2*h21^2 + 2*h15^2*h21*h23*t3^4 - 2*h15^2*h21*h23 + h15^2*h22^2*t3^4 - 2*h15^2*h22^2*t3^2 + h15^2*h22^2 - 4*h15^2*h22*h25*t3^3 + 4*h15^2*h22*h25*t3 - h15^2*h23^2*t3^4 + 2*h15^2*h23^2*t3^2 - h15^2*h23^2 + 4*h15^2*h25^2*t3^2);
b0=h30 + h31 + h32 + h33 + 2*h34*t3 + h30*t3^2 - h31*t3^2 + h32*t3^2 - h33*t3^2;
b1=(2*h35*t3^2 + 4*h36*t3 + 2*h35);
b2=(h30 + h31 - h32 - h33 + 2*h34*t3 + h30*t3^2 - h31*t3^2 - h32*t3^2 + h33*t3^2);
%h_th=a4*(a4*b0^4+b1*(-a3*b0^3+b1*(a2*b0^2-a1*b0*b1+a0*b1^2)))+b2*((a3^2-2*a2*a4)*b0^3+(-a2*a3+3*a1*a4)*b0^2*b1+(a1*a3-4*a0*a4)*b0*b1^2-a0*a3*b1^3)+b2^2*((a2^2-2*a1*a3+2*a0*a4)*b0^2+(-a1*a2+3*a0*a3)*b0*b1+a0*a2*b1^2)+b2^3*((a1^2-2*a0*a2)*b0-a0*a1*b1)+a0^2*b2^4;
h=a0^2*b2^4 - a0*a1*b1*b2^3 - 2*a0*a2*b0*b2^3 + a0*a2*b1^2*b2^2 + 3*a0*a3*b0*b1*b2^2 - a0*a3*b1^3*b2 + 2*a0*a4*b0^2*b2^2 - 4*a0*a4*b0*b1^2*b2 + a0*a4*b1^4 + a1^2*b0*b2^3 - a1*a2*b0*b1*b2^2 - 2*a1*a3*b0^2*b2^2 + a1*a3*b0*b1^2*b2 + 3*a1*a4*b0^2*b1*b2 - a1*a4*b0*b1^3 + a2^2*b0^2*b2^2 - a2*a3*b0^2*b1*b2 - 2*a2*a4*b0^3*b2 + a2*a4*b0^2*b1^2 + a3^2*b0^3*b2 - a3*a4*b0^3*b1 + a4^2*b0^4;
t3val=solve(h,t3);
t3real=vpa(t3val,4);
t3no=t3real(4,1);
%t1=(a4*b0*b1^2-b0*(a4*b0+a3*b1)*b2+a2*b0*b2^2-a0*b2^3)/(-a4*b1^3+b1*(2*a4*b0+a3*b1)*b2-(a3*b0+a2*b1)*b2^2+a1*b2^3);
t1=(-a0*b2^3+a2*b0*b2^2-a4*b0^2*b2+a4*b0*b1^2-a3*b0*b1*b2)/(a1*b2^3-a3*b0*b2^2+a3*b1^2*b2-a2*b1*b2^2+2*a4*b0*b1*b2-a4*b1^3);
t1fi1=subs(t1,t3,t3no);
%st1=b0+b1*t1+b2*t1^2==0;
%t1=solve(st1);
%t1fi1=subs(t1(2,1),t3,t3no);
f10=h10+h11+2*h14*t1fi1+(h10-h11)*t1fi1^2;
f11=h15+2*h16*t1fi1+h15*t1fi1^2;
f12=h12+h13+(h12-h13)*t1fi1^2;
f20=h20+h22+2*h25*t3no+(h20-h22)*t3no^2;
f21=h24+2*h26*t3no+h24*t3no^2;
f22=h21+h23+(h21-h23)*t3no^2;
fi1=2*atan(t1fi1)*(180/pi)
fi3=2*atan(t3no)*(180/pi)
sfi2=((f10*f22)-(f12*f20))/((f12*f21)-(f11*f22));
%sfi2=((f12*f20)-(f10*f22))/((f11*f22)-(f12*f21));
cfi2=((f10*f21)-(f11*f20))/((f11*f22)-(f12*f21));
fi2=atan2(sfi2,cfi2)*(180/pi)

O74=[b+l1*(cos(th1*pi/180))+l2*cos(fi1*pi/180);0;-l1*sin(th1*pi/180)-l2*sin(fi1*pi/180)];
O75=[-0.5*(b+l1*cos(th2*pi/180)+l2*cos(fi2*pi/180));0.866*(b+l1*cos(th2*pi/180)+l2*cos(fi2*pi/180));-l1*sin(th2*pi/180)-l2*sin(fi2*pi/180)];
O76=[-0.5*(b+l1*cos(th3*pi/180)+l2*cos(fi3*pi/180));-0.866*(b+l1*cos(th3*pi/180)+l2*cos(fi3*pi/180));-l1*sin(th3*pi/180)-l2*sin(fi3*pi/180)];
P=(1/3)*(O74+O75+O76);
O7=double(subs(P))
ux=(O74(1,1)-O7(1,1))/p;
uy=(O74(2,1)-O7(2,1))/p;
uz=(O74(3,1)-O7(3,1))/p;
vx=(O75(1,1)-O7(1,1)+(0.5*p*ux))/(0.866*p);
vy=(-1.732*O75(1,1)-O7(2,1)+(0.5*p*uy))/(0.866*p);
vz=(O75(3,1)-O7(3,1)+(0.5*p*uz))/(0.866*p);
E1=wx^2+wy^2+wz^2==1;
E2=ux*wx+uy*wy+uz*wz==0;
E3=vx*wx+vy*wy+vz*wz==0;
result = solve(E1,E2,E3);
wx=vpa(result.wx);
wy=vpa(result.wy);
wz=vpa(result.wz);
ebsyy=asin(vpa(result.wx))*(180/pi)
ebsyx=atan2(-vpa(result.wy),vpa(result.wz))*(180/pi)
R=[ux uy uz O7(1,1);vx vy vz O7(2,1);wx(2,1) wy(2,1) wz(2,1) O7(3,1);0 0 0 1];
Rab=double(subs(R))